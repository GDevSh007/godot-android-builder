name: ðŸ¤– Android Arm64 Template (Standard)
on:
  workflow_call:
  workflow_dispatch:

jobs:
  build-android:
    runs-on: ubuntu-24.04
    name: Android Arm64 Template
    timeout-minutes: 60
    steps:
      - name: Checkout Godot Source
        uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Set up Java 17
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 17

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Install SCons
        run: |
          python -m pip install scons

      - name: Download Swappy
        run: |
          python ./misc/scripts/install_swappy_android.py

      - name: Compilation
        run: |
          scons platform=android \
                target=template_debug \
                arch=arm64 \
                build_profile=.github/workflows/ludmax.gdbuild \
                dev_mode=yes \
                module_text_server_fb_enabled=yes \
                tests=no \
                swappy=yes

      - name: Generate Godot templates (Gradle)
        run: |
          cd platform/android/java
          ./gradlew generateGodotTemplates
          cd ../../..

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: android-template-arm64-ludmax
          path: bin/
